/////////////////////////////////////////////////////////////////////
////                                                             ////
////  Post Norm                                                  ////
////  Floating Point Post Normalisation Unit                     ////
////                                                             ////
////  Author: Rudolf Usselmann                                   ////
////          rudi@asics.ws                                      ////
////                                                             ////
/////////////////////////////////////////////////////////////////////
////                                                             ////
//// Copyright (C) 2000 Rudolf Usselmann                         ////
////                    rudi@asics.ws                            ////
////                                                             ////
//// This source file may be used and distributed without        ////
//// restriction provided that this copyright statement is not   ////
//// removed from the file and that any derivative work contains ////
//// the original copyright notice and the associated disclaimer.////
////                                                             ////
////     THIS SOFTWARE IS PROVIDED ``AS IS'' AND WITHOUT ANY     ////
//// EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED   ////
//// TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS   ////
//// FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL THE AUTHOR      ////
//// OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,         ////
//// INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES    ////
//// (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE   ////
//// GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR        ////
//// BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF  ////
//// LIABILITY, WHETHER IN  CONTRACT, STRICT LIABILITY, OR TORT  ////
//// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT  ////
//// OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE         ////
//// POSSIBILITY OF SUCH DAMAGE.                                 ////
////                                                             ////
/////////////////////////////////////////////////////////////////////


`timescale 1ns / 100ps

<<<<<<< HEAD
`define BIT_SIZE 15 
`define EXP_SIZE 4
`define MANT_SIZE 9 
`define BIAS 15
`define EXP_SHIFT 3
=======


`define BIT_SIZE 63
`define EXP_SIZE 10
`define MANT_SIZE 51
`define BIAS 1023
`define EXP_SHIFT 5

>>>>>>> 19bcd6ae7dd75d2fa45f393a96c8f1177c0bf471

module post_norm( clk, fpu_op, opas, sign, rmode, fract_in, exp_in, exp_ovf,
		opa_dn, opb_dn, rem_00, div_opa_ldz, output_zero, out,
		ine, overflow, underflow, f2i_out_sign);



input		clk;
input	[2:0]	fpu_op;
input		opas;
input		sign;
input	[1:0]	rmode;
input	[(`MANT_SIZE + 1) * 2 + 1:0]	fract_in;
input	[1:0]	exp_ovf;
input	[`EXP_SIZE:0]	exp_in;
input		opa_dn, opb_dn;
input		rem_00;
input	[4:0]	div_opa_ldz;
input		output_zero;
output	[`BIT_SIZE-1:0]	out;
output		ine;
output		overflow, underflow;
output		f2i_out_sign;

////////////////////////////////////////////////////////////////////////
//
// Local Wires and registers
//

wire	[`MANT_SIZE:0]	fract_out;
wire	[`EXP_SIZE:0]	exp_out;
wire	[`BIT_SIZE-1:0]	out;
wire		exp_out1_co, overflow, underflow;
wire	[`MANT_SIZE:0]	fract_out_final;
reg	[`MANT_SIZE:0]	fract_out_rnd;
wire	[`EXP_SIZE+1:0]	exp_next_mi;
wire		dn;
wire		exp_rnd_adj;
wire	[`EXP_SIZE:0]	exp_out_final;
reg	[`EXP_SIZE:0]	exp_out_rnd;
wire		op_dn = opa_dn | opb_dn;
wire		op_mul = fpu_op[2:0]==3'b010;
wire		op_div = fpu_op[2:0]==3'b011;
wire		op_i2f = fpu_op[2:0]==3'b100;
wire		op_f2i = fpu_op[2:0]==3'b101;
reg	[6:0]	fi_ldz;

wire		g, r, s;
wire		round, round2, round2a, round2_fasu, round2_fmul;
wire	[`EXP_SIZE:0]	exp_out_rnd0, exp_out_rnd1, exp_out_rnd2, exp_out_rnd2a;
wire	[`MANT_SIZE:0]	fract_out_rnd0, fract_out_rnd1, fract_out_rnd2, fract_out_rnd2a;
wire		exp_rnd_adj0, exp_rnd_adj2a;
wire		r_sign;
wire		ovf0, ovf1;
wire	[`MANT_SIZE+1:0]	fract_out_pl1;
wire	[`EXP_SIZE:0]	exp_out_pl1, exp_out_mi1;
wire		exp_out_00, exp_out_fe, exp_out_ff, exp_in_00, exp_in_ff;
wire		exp_out_final_ff, fract_out_7fffff;
wire	[`MANT_SIZE + 2 :0]	fract_trunc;
wire	[`EXP_SIZE:0]	exp_out1;
wire		grs_sel;
wire		fract_out_00, fract_in_00;
wire		shft_co;
wire	[`EXP_SIZE+1:0]	exp_in_pl1, exp_in_mi1;
wire	[(`MANT_SIZE + 1) * 2 + 1:0]	fract_in_shftr;
wire	[(`MANT_SIZE + 1) * 2 + 1:0]	fract_in_shftl;

wire	[`EXP_SIZE:0]	exp_div;
wire	[`EXP_SIZE:0]	shft2;
wire	[`EXP_SIZE:0]	exp_out1_mi1;
wire		div_dn;
wire		div_nr;
wire		grs_sel_div;

wire		div_inf;
wire	[6:0]	fi_ldz_2a;
wire	[`EXP_SIZE:0]	fi_ldz_2;
wire	[`EXP_SIZE:0]	div_shft1, div_shft2, div_shft3, div_shft4;
wire		div_shft1_co;
wire	[`EXP_SIZE+1:0]	div_exp1;
wire	[`EXP_SIZE:0]	div_exp2, div_exp3;
wire		left_right, lr_mul, lr_div;
wire	[`EXP_SIZE:0]	shift_right, shftr_mul, shftr_div;
wire	[`EXP_SIZE:0]	shift_left,  shftl_mul, shftl_div;
wire	[`EXP_SIZE:0]	fasu_shift;
wire	[`EXP_SIZE:0]	exp_fix_div;

wire	[`EXP_SIZE:0]	exp_fix_diva, exp_fix_divb;
wire	[6:0]	fi_ldz_mi1;
wire	[6:0]	fi_ldz_mi22;
wire		exp_zero;
wire	[6:0]	ldz_all;
wire	[`EXP_SIZE:0]	ldz_dif;

wire	[`EXP_SIZE+1:0]	div_scht1a;
wire	[`EXP_SIZE:0]	f2i_shft;
wire	[`BIT_SIZE + 1 + `MANT_SIZE + 2:0]	exp_f2i_1;
wire		f2i_zero, f2i_max;
wire	[`EXP_SIZE:0]	f2i_emin;
wire	[`EXP_SIZE:0]	conv_shft;
wire	[`EXP_SIZE:0]	exp_i2f, exp_f2i, conv_exp;
wire		round2_f2i;




////////////////////////////////////////////////////////////////////////
//
// Normalize and Round Logic
//

// ---------------------------------------------------------------------
// Count Leading zeros in fraction

always @(fract_in) begin

  if(`BIT_SIZE == 15) begin
  casex(fract_in)
  22'b1?????????????????????: fi_ldz = 1;
  22'b01????????????????????: fi_ldz = 2;
  22'b001???????????????????: fi_ldz = 3;
  22'b0001??????????????????: fi_ldz = 4;
  22'b00001?????????????????: fi_ldz = 5;
  22'b000001????????????????: fi_ldz = 6;
  22'b0000001???????????????: fi_ldz = 7;
  22'b00000001??????????????: fi_ldz = 8;
  22'b000000001?????????????: fi_ldz = 9;
  22'b0000000001????????????: fi_ldz = 10;
  22'b00000000001???????????: fi_ldz = 11;
  22'b000000000001??????????: fi_ldz = 12;
  22'b0000000000001?????????: fi_ldz = 13;
  22'b00000000000001????????: fi_ldz = 14;
  22'b000000000000001???????: fi_ldz = 15;
  22'b0000000000000001??????: fi_ldz = 16;
  22'b00000000000000001?????: fi_ldz = 17;
  22'b000000000000000001????: fi_ldz = 18;
  22'b0000000000000000001???: fi_ldz = 19;
  22'b00000000000000000001??: fi_ldz = 20;
  22'b000000000000000000001?: fi_ldz = 21;
  22'b000000000000000000000?: fi_ldz = 22;
  default: fi_ldz = 6'bx; 
  endcase

  end

  if(`BIT_SIZE == 31) begin
   casex(fract_in)	/// synopsys full_case parallel_case
	48'b1???????????????????????????????????????????????: fi_ldz =  1;
	48'b01??????????????????????????????????????????????: fi_ldz =  2;
	48'b001?????????????????????????????????????????????: fi_ldz =  3;
	48'b0001????????????????????????????????????????????: fi_ldz =  4;
	48'b00001???????????????????????????????????????????: fi_ldz =  5;
	48'b000001??????????????????????????????????????????: fi_ldz =  6;
	48'b0000001?????????????????????????????????????????: fi_ldz =  7;
	48'b00000001????????????????????????????????????????: fi_ldz =  8;
	48'b000000001???????????????????????????????????????: fi_ldz =  9;
	48'b0000000001??????????????????????????????????????: fi_ldz =  10;
	48'b00000000001?????????????????????????????????????: fi_ldz =  11;
	48'b000000000001????????????????????????????????????: fi_ldz =  12;
	48'b0000000000001???????????????????????????????????: fi_ldz =  13;
	48'b00000000000001??????????????????????????????????: fi_ldz =  14;
	48'b000000000000001?????????????????????????????????: fi_ldz =  15;
	48'b0000000000000001????????????????????????????????: fi_ldz =  16;
	48'b00000000000000001???????????????????????????????: fi_ldz =  17;
	48'b000000000000000001??????????????????????????????: fi_ldz =  18;
	48'b0000000000000000001?????????????????????????????: fi_ldz =  19;
	48'b00000000000000000001????????????????????????????: fi_ldz =  20;
	48'b000000000000000000001???????????????????????????: fi_ldz =  21;
	48'b0000000000000000000001??????????????????????????: fi_ldz =  22;
	48'b00000000000000000000001?????????????????????????: fi_ldz =  23;
	48'b000000000000000000000001????????????????????????: fi_ldz =  24;
	48'b0000000000000000000000001???????????????????????: fi_ldz =  25;
	48'b00000000000000000000000001??????????????????????: fi_ldz =  26;
	48'b000000000000000000000000001?????????????????????: fi_ldz =  27;
	48'b0000000000000000000000000001????????????????????: fi_ldz =  28;
	48'b00000000000000000000000000001???????????????????: fi_ldz =  29;
	48'b000000000000000000000000000001??????????????????: fi_ldz =  30;
	48'b0000000000000000000000000000001?????????????????: fi_ldz =  31;
	48'b00000000000000000000000000000001????????????????: fi_ldz =  32;
	48'b000000000000000000000000000000001???????????????: fi_ldz =  33;
	48'b0000000000000000000000000000000001??????????????: fi_ldz =  34;
	48'b00000000000000000000000000000000001?????????????: fi_ldz =  35;
	48'b000000000000000000000000000000000001????????????: fi_ldz =  36;
	48'b0000000000000000000000000000000000001???????????: fi_ldz =  37;
	48'b00000000000000000000000000000000000001??????????: fi_ldz =  38;
	48'b000000000000000000000000000000000000001?????????: fi_ldz =  39;
	48'b0000000000000000000000000000000000000001????????: fi_ldz =  40;
	48'b00000000000000000000000000000000000000001???????: fi_ldz =  41;
	48'b000000000000000000000000000000000000000001??????: fi_ldz =  42;
	48'b0000000000000000000000000000000000000000001?????: fi_ldz =  43;
	48'b00000000000000000000000000000000000000000001????: fi_ldz =  44;
	48'b000000000000000000000000000000000000000000001???: fi_ldz =  45;
	48'b0000000000000000000000000000000000000000000001??: fi_ldz =  46;
	48'b00000000000000000000000000000000000000000000001?: fi_ldz =  47;
	48'b00000000000000000000000000000000000000000000000?: fi_ldz =  48;
	default: fi_ldz = 6'bx; 
   endcase
   end



   if(`BIT_SIZE == 63) begin
   casex(fract_in)
    106'b1?????????????????????????????????????????????????????????????????????????????????????????????????????????: fi_ldz = 1;
    106'b01????????????????????????????????????????????????????????????????????????????????????????????????????????: fi_ldz = 2;
    106'b001???????????????????????????????????????????????????????????????????????????????????????????????????????: fi_ldz = 3;
    106'b0001??????????????????????????????????????????????????????????????????????????????????????????????????????: fi_ldz = 4;
    106'b00001?????????????????????????????????????????????????????????????????????????????????????????????????????: fi_ldz = 5;
    106'b000001????????????????????????????????????????????????????????????????????????????????????????????????????: fi_ldz = 6;
    106'b0000001???????????????????????????????????????????????????????????????????????????????????????????????????: fi_ldz = 7;
    106'b00000001??????????????????????????????????????????????????????????????????????????????????????????????????: fi_ldz = 8;
    106'b000000001?????????????????????????????????????????????????????????????????????????????????????????????????: fi_ldz = 9;
    106'b0000000001????????????????????????????????????????????????????????????????????????????????????????????????: fi_ldz = 10;
    106'b00000000001???????????????????????????????????????????????????????????????????????????????????????????????: fi_ldz = 11;
    106'b000000000001??????????????????????????????????????????????????????????????????????????????????????????????: fi_ldz = 12;
    106'b0000000000001?????????????????????????????????????????????????????????????????????????????????????????????: fi_ldz = 13;
    106'b00000000000001????????????????????????????????????????????????????????????????????????????????????????????: fi_ldz = 14;
    106'b000000000000001???????????????????????????????????????????????????????????????????????????????????????????: fi_ldz = 15;
    106'b0000000000000001??????????????????????????????????????????????????????????????????????????????????????????: fi_ldz = 16;
    106'b00000000000000001?????????????????????????????????????????????????????????????????????????????????????????: fi_ldz = 17;
    106'b000000000000000001????????????????????????????????????????????????????????????????????????????????????????: fi_ldz = 18;
    106'b0000000000000000001???????????????????????????????????????????????????????????????????????????????????????: fi_ldz = 19;
    106'b00000000000000000001??????????????????????????????????????????????????????????????????????????????????????: fi_ldz = 20;
    106'b000000000000000000001?????????????????????????????????????????????????????????????????????????????????????: fi_ldz = 21;
    106'b0000000000000000000001????????????????????????????????????????????????????????????????????????????????????: fi_ldz = 22;
    106'b00000000000000000000001???????????????????????????????????????????????????????????????????????????????????: fi_ldz = 23;
    106'b000000000000000000000001??????????????????????????????????????????????????????????????????????????????????: fi_ldz = 24;
    106'b0000000000000000000000001?????????????????????????????????????????????????????????????????????????????????: fi_ldz = 25;
    106'b00000000000000000000000001????????????????????????????????????????????????????????????????????????????????: fi_ldz = 26;
    106'b000000000000000000000000001???????????????????????????????????????????????????????????????????????????????: fi_ldz = 27;
    106'b0000000000000000000000000001??????????????????????????????????????????????????????????????????????????????: fi_ldz = 28;
    106'b00000000000000000000000000001?????????????????????????????????????????????????????????????????????????????: fi_ldz = 29;
    106'b000000000000000000000000000001????????????????????????????????????????????????????????????????????????????: fi_ldz = 30;
    106'b0000000000000000000000000000001???????????????????????????????????????????????????????????????????????????: fi_ldz = 31;
    106'b00000000000000000000000000000001??????????????????????????????????????????????????????????????????????????: fi_ldz = 32;
    106'b000000000000000000000000000000001?????????????????????????????????????????????????????????????????????????: fi_ldz = 33;
    106'b0000000000000000000000000000000001????????????????????????????????????????????????????????????????????????: fi_ldz = 34;
    106'b00000000000000000000000000000000001???????????????????????????????????????????????????????????????????????: fi_ldz = 35;
    106'b000000000000000000000000000000000001??????????????????????????????????????????????????????????????????????: fi_ldz = 36;
    106'b0000000000000000000000000000000000001?????????????????????????????????????????????????????????????????????: fi_ldz = 37;
    106'b00000000000000000000000000000000000001????????????????????????????????????????????????????????????????????: fi_ldz = 38;
    106'b000000000000000000000000000000000000001???????????????????????????????????????????????????????????????????: fi_ldz = 39;
    106'b0000000000000000000000000000000000000001??????????????????????????????????????????????????????????????????: fi_ldz = 40;
    106'b00000000000000000000000000000000000000001?????????????????????????????????????????????????????????????????: fi_ldz = 41;
    106'b000000000000000000000000000000000000000001????????????????????????????????????????????????????????????????: fi_ldz = 42;
    106'b0000000000000000000000000000000000000000001???????????????????????????????????????????????????????????????: fi_ldz = 43;
    106'b00000000000000000000000000000000000000000001??????????????????????????????????????????????????????????????: fi_ldz = 44;
    106'b000000000000000000000000000000000000000000001?????????????????????????????????????????????????????????????: fi_ldz = 45;
    106'b0000000000000000000000000000000000000000000001????????????????????????????????????????????????????????????: fi_ldz = 46;
    106'b00000000000000000000000000000000000000000000001???????????????????????????????????????????????????????????: fi_ldz = 47;
    106'b000000000000000000000000000000000000000000000001??????????????????????????????????????????????????????????: fi_ldz = 48;
    106'b0000000000000000000000000000000000000000000000001?????????????????????????????????????????????????????????: fi_ldz = 49;
    106'b00000000000000000000000000000000000000000000000001????????????????????????????????????????????????????????: fi_ldz = 50;
    106'b000000000000000000000000000000000000000000000000001???????????????????????????????????????????????????????: fi_ldz = 51;
    106'b0000000000000000000000000000000000000000000000000001??????????????????????????????????????????????????????: fi_ldz = 52;
    106'b00000000000000000000000000000000000000000000000000001?????????????????????????????????????????????????????: fi_ldz = 53;
    106'b000000000000000000000000000000000000000000000000000001????????????????????????????????????????????????????: fi_ldz = 54;
    106'b0000000000000000000000000000000000000000000000000000001???????????????????????????????????????????????????: fi_ldz = 55;
    106'b00000000000000000000000000000000000000000000000000000001??????????????????????????????????????????????????: fi_ldz = 56;
    106'b000000000000000000000000000000000000000000000000000000001?????????????????????????????????????????????????: fi_ldz = 57;
    106'b0000000000000000000000000000000000000000000000000000000001????????????????????????????????????????????????: fi_ldz = 58;
    106'b00000000000000000000000000000000000000000000000000000000001???????????????????????????????????????????????: fi_ldz = 59;
    106'b000000000000000000000000000000000000000000000000000000000001??????????????????????????????????????????????: fi_ldz = 60;
    106'b0000000000000000000000000000000000000000000000000000000000001?????????????????????????????????????????????: fi_ldz = 61;
    106'b00000000000000000000000000000000000000000000000000000000000001????????????????????????????????????????????: fi_ldz = 62;
    106'b000000000000000000000000000000000000000000000000000000000000001???????????????????????????????????????????: fi_ldz = 63;
    106'b0000000000000000000000000000000000000000000000000000000000000001??????????????????????????????????????????: fi_ldz = 64;
    106'b00000000000000000000000000000000000000000000000000000000000000001?????????????????????????????????????????: fi_ldz = 65;
    106'b000000000000000000000000000000000000000000000000000000000000000001????????????????????????????????????????: fi_ldz = 66;
    106'b0000000000000000000000000000000000000000000000000000000000000000001???????????????????????????????????????: fi_ldz = 67;
    106'b00000000000000000000000000000000000000000000000000000000000000000001??????????????????????????????????????: fi_ldz = 68;
    106'b000000000000000000000000000000000000000000000000000000000000000000001?????????????????????????????????????: fi_ldz = 69;
    106'b0000000000000000000000000000000000000000000000000000000000000000000001????????????????????????????????????: fi_ldz = 70;
    106'b00000000000000000000000000000000000000000000000000000000000000000000001???????????????????????????????????: fi_ldz = 71;
    106'b000000000000000000000000000000000000000000000000000000000000000000000001??????????????????????????????????: fi_ldz = 72;
    106'b0000000000000000000000000000000000000000000000000000000000000000000000001?????????????????????????????????: fi_ldz = 73;
    106'b00000000000000000000000000000000000000000000000000000000000000000000000001????????????????????????????????: fi_ldz = 74;
    106'b000000000000000000000000000000000000000000000000000000000000000000000000001???????????????????????????????: fi_ldz = 75;
    106'b0000000000000000000000000000000000000000000000000000000000000000000000000001??????????????????????????????: fi_ldz = 76;
    106'b00000000000000000000000000000000000000000000000000000000000000000000000000001?????????????????????????????: fi_ldz = 77;
    106'b000000000000000000000000000000000000000000000000000000000000000000000000000001????????????????????????????: fi_ldz = 78;
    106'b0000000000000000000000000000000000000000000000000000000000000000000000000000001???????????????????????????: fi_ldz = 79;
    106'b00000000000000000000000000000000000000000000000000000000000000000000000000000001??????????????????????????: fi_ldz = 80;
    106'b000000000000000000000000000000000000000000000000000000000000000000000000000000001?????????????????????????: fi_ldz = 81;
    106'b0000000000000000000000000000000000000000000000000000000000000000000000000000000001????????????????????????: fi_ldz = 82;
    106'b00000000000000000000000000000000000000000000000000000000000000000000000000000000001???????????????????????: fi_ldz = 83;
    106'b000000000000000000000000000000000000000000000000000000000000000000000000000000000001??????????????????????: fi_ldz = 84;
    106'b0000000000000000000000000000000000000000000000000000000000000000000000000000000000001?????????????????????: fi_ldz = 85;
    106'b00000000000000000000000000000000000000000000000000000000000000000000000000000000000001????????????????????: fi_ldz = 86;
    106'b000000000000000000000000000000000000000000000000000000000000000000000000000000000000001???????????????????: fi_ldz = 87;
    106'b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000001??????????????????: fi_ldz = 88;
    106'b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000001?????????????????: fi_ldz = 89;
    106'b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001????????????????: fi_ldz = 90;
    106'b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001???????????????: fi_ldz = 91;
    106'b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001??????????????: fi_ldz = 92;
    106'b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001?????????????: fi_ldz = 93;
    106'b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001????????????: fi_ldz = 94;
    106'b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001???????????: fi_ldz = 95;
    106'b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001??????????: fi_ldz = 96;
    106'b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001?????????: fi_ldz = 97;
    106'b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001????????: fi_ldz = 98;
    106'b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001???????: fi_ldz = 99;
    106'b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001??????: fi_ldz = 100;
    106'b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001?????: fi_ldz = 101;
    106'b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001????: fi_ldz = 102;
    106'b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001???: fi_ldz = 103;
    106'b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001??: fi_ldz = 104;
    106'b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001?: fi_ldz = 105;
    106'b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000?: fi_ldz = 106;
    default: fi_ldz = 6'bx;
  endcase


   end

   end


// ---------------------------------------------------------------------
// Normalize

wire		exp_in_80;
wire		rmode_00, rmode_01, rmode_10, rmode_11;

// Misc common signals
assign exp_in_ff        = &exp_in;
assign exp_in_00        = !(|exp_in);
assign exp_in_80	= exp_in[`EXP_SIZE] & !(|exp_in[`EXP_SIZE - 1:0]);
assign exp_out_ff       = &exp_out;
assign exp_out_00       = !(|exp_out);
assign exp_out_fe       = &exp_out[`EXP_SIZE:1] & !exp_out[0];
assign exp_out_final_ff = &exp_out_final;

assign fract_out_7fffff = &fract_out;
assign fract_out_00     = !(|fract_out);
assign fract_in_00      = !(|fract_in);

assign rmode_00 = (rmode==2'b00);
assign rmode_01 = (rmode==2'b01);
assign rmode_10 = (rmode==2'b10);
assign rmode_11 = (rmode==2'b11);

// Fasu Output will be denormalized ...
assign dn = !op_mul & !op_div & (exp_in_00 | (exp_next_mi[`EXP_SIZE + 1] & !fract_in[(`MANT_SIZE + 1)* 2 + 1]) );

// ---------------------------------------------------------------------
// Fraction Normalization
parameter	f2i_emax = 8'h9d; // 157? but why though TODO FIX THIS

// Incremented fraction for rounding
assign fract_out_pl1 = fract_out + 1;

// Special Signals for f2i
//assign f2i_emin = rmode_00 ? 8'h7e : 8'h7f; //126 : 127
assign f2i_emin = rmode_00 ? `BIAS-1 : `BIAS; //126 : 127
assign f2i_zero = (!opas & (exp_in<f2i_emin)) | (opas & (exp_in>f2i_emax)) | (opas & (exp_in<f2i_emin) & (fract_in_00 | !rmode_11));
assign f2i_max = (!opas & (exp_in>f2i_emax)) | (opas & (exp_in<f2i_emin) & !fract_in_00 & rmode_11);

// Calculate various shifting options

assign {shft_co,shftr_mul} = (!exp_ovf[1] & exp_in_00) ? {1'b0, exp_out} : exp_in_mi1 ;
assign {div_shft1_co, div_shft1} = exp_in_00 ? {1'b0, div_opa_ldz} : div_scht1a;

assign div_scht1a = exp_in-div_opa_ldz; // 9 bits - includes carry out
assign div_shft2  = exp_in+2;
assign div_shft3  = div_opa_ldz+exp_in;
assign div_shft4  = div_opa_ldz-exp_in;

assign div_dn    = op_dn & div_shft1_co;
assign div_nr    = op_dn & exp_ovf[1]  & !(|fract_in[(`MANT_SIZE + 1)*2:`MANT_SIZE + 1]) & (div_shft3>`MANT_SIZE);

assign f2i_shft  = exp_in-8'h7d; //125

// Select shifting direction
assign left_right = op_div ? lr_div : op_mul ? lr_mul : 1;

assign lr_div = 	(op_dn & !exp_ovf[1] & exp_ovf[0])     ? 1 :
			(op_dn & exp_ovf[1])                   ? 0 :
			(op_dn & div_shft1_co)                 ? 0 :
			(op_dn & exp_out_00)                   ? 1 :
			(!op_dn & exp_out_00 & !exp_ovf[1])    ? 1 :
			exp_ovf[1]                             ? 0 :
			                                         1;
assign lr_mul = 	(shft_co | (!exp_ovf[1] & exp_in_00) |
			(!exp_ovf[1] & !exp_in_00 & (exp_out1_co | exp_out_00) )) ? 	1 :
			( exp_ovf[1] | exp_in_00 ) ?					0 :
											1;

// Select Left and Right shift value
assign fasu_shift  = (dn | exp_out_00) ? (exp_in_00 ? 8'h2 : exp_in_pl1[`EXP_SIZE:0]) : {2'h0, fi_ldz};
assign shift_right = op_div ? shftr_div : shftr_mul;

assign conv_shft = op_f2i ? f2i_shft : {2'h0, fi_ldz};

assign shift_left  = op_div ? shftl_div : op_mul ? shftl_mul : (op_f2i | op_i2f) ? conv_shft : fasu_shift;

assign shftl_mul = 	(shft_co |
			(!exp_ovf[1] & exp_in_00) |
			(!exp_ovf[1] & !exp_in_00 & (exp_out1_co | exp_out_00))) ? exp_in_pl1[`EXP_SIZE:0] : {2'h0, fi_ldz};

assign shftl_div = 	( op_dn & exp_out_00 & !(!exp_ovf[1] & exp_ovf[0]))	? div_shft1[`EXP_SIZE:0] :
			(!op_dn & exp_out_00 & !exp_ovf[1])    			? exp_in[`EXP_SIZE:0] :
			                                        		 {2'h0, fi_ldz};
assign shftr_div = 	(op_dn & exp_ovf[1])                   ? div_shft3 :
			(op_dn & div_shft1_co)                 ? div_shft4 :
								 div_shft2;
// Do the actual shifting
assign fract_in_shftr   = (|shift_right[`EXP_SIZE:`EXP_SIZE-1])            ? 0 : fract_in>>shift_right[`EXP_SIZE - 2:0];
assign fract_in_shftl   = (|shift_left[`EXP_SIZE:`EXP_SIZE-1] | (f2i_zero & op_f2i)) ? 0 : fract_in<<shift_left[`EXP_SIZE - 2:0];

// Chose final fraction output
assign {fract_out,fract_trunc} = left_right ? fract_in_shftl : fract_in_shftr;

// ---------------------------------------------------------------------
// Exponent Normalization

assign fi_ldz_mi1    = fi_ldz - 1;
assign fi_ldz_mi22   = fi_ldz - `MANT_SIZE;
assign exp_out_pl1   = exp_out + 1;
assign exp_out_mi1   = exp_out - 1;
assign exp_in_pl1    = exp_in  + 1;	// 9 bits - includes carry out
assign exp_in_mi1    = exp_in  - 1;	// 9 bits - includes carry out
assign exp_out1_mi1  = exp_out1 - 1;

assign exp_next_mi  = exp_in_pl1 - fi_ldz_mi1;	// 9 bits - includes carry out

assign exp_fix_diva = exp_in - fi_ldz_mi22;
assign exp_fix_divb = exp_in - fi_ldz_mi1;

assign exp_zero  = (exp_ovf[1] & !exp_ovf[0] & op_mul & (!exp_rnd_adj2a | !rmode[1])) | (op_mul & exp_out1_co);
assign {exp_out1_co, exp_out1} = fract_in[(`MANT_SIZE + 1)* 2 + 1] ? exp_in_pl1 : exp_next_mi;

assign f2i_out_sign =  !opas ? ((exp_in<f2i_emin) ? 0 : (exp_in>f2i_emax) ? 0 : opas) :
			       ((exp_in<f2i_emin) ? 0 : (exp_in>f2i_emax) ? 1 : opas);

assign exp_i2f   = fract_in_00 ? (opas ? 8'h9e : 0) : (8'h9e-fi_ldz);
assign exp_f2i_1 = {{8{fract_in[(`MANT_SIZE + 1)* 2 + 1]}}, fract_in }<<f2i_shft;
//assign exp_f2i   = f2i_zero ? 0 : f2i_max ? 8'hff : exp_f2i_1[`BIT_SIZE + 1 + `MANT_SIZE + 2:`BIT_SIZE + 1 + `MANT_SIZE + 2 - `EXP_SIZE]; //TODO FIGURE OUT WHAT THIS DOES
assign exp_f2i   = f2i_zero ? 0 : f2i_max ? 2**(`EXP_SIZE + 1) : exp_f2i_1[`BIT_SIZE + 1 + `MANT_SIZE + 2:`BIT_SIZE + 1 + `MANT_SIZE + 2 - `EXP_SIZE];
assign conv_exp  = op_f2i ? exp_f2i : exp_i2f;

assign exp_out = op_div ? exp_div : (op_f2i | op_i2f) ? conv_exp : exp_zero ? 8'h0 : dn ? {6'h0, fract_in[(`MANT_SIZE + 1)* 2 + 1:(`MANT_SIZE + 1)* 2]} : exp_out1;

assign ldz_all   = div_opa_ldz + fi_ldz;
assign ldz_dif   = fi_ldz_2 - div_opa_ldz;
assign fi_ldz_2a = (`MANT_SIZE + 1) - fi_ldz;
assign fi_ldz_2  = {fi_ldz_2a[6], fi_ldz_2a[6:0]};

assign div_exp1  = exp_in_mi1 + fi_ldz_2;	// 9 bits - includes carry out

assign div_exp2  = exp_in_pl1 - ldz_all;
assign div_exp3  = exp_in + ldz_dif;

assign exp_div =(opa_dn & opb_dn)					? div_exp3 :
		 opb_dn							? div_exp1[`EXP_SIZE:0] :
		(opa_dn & !( (exp_in<div_opa_ldz) | (div_exp2>9'hfe) ))	? div_exp2 :
		(opa_dn | (exp_in_00 & !exp_ovf[1]) )			? 0 :
									  exp_out1_mi1;

assign div_inf = opb_dn & !opa_dn & (div_exp1[`EXP_SIZE:0] < `BIAS);

// ---------------------------------------------------------------------
// Round

// Extract rounding (GRS) bits
assign grs_sel_div = op_div & (exp_ovf[1] | div_dn | exp_out1_co | exp_out_00);

assign g = grs_sel_div ? fract_out[0]                   : fract_out[0];
assign r = grs_sel_div ? (fract_trunc[`MANT_SIZE + 2] & !div_nr)    : fract_trunc[`MANT_SIZE + 2];
assign s = grs_sel_div ? |fract_trunc[`MANT_SIZE + 2:0]             : (|fract_trunc[`MANT_SIZE + 1:0] | (fract_trunc[`MANT_SIZE + 2] & op_div));

// Round to nearest even
assign round = (g & r) | (r & s) ;
assign {exp_rnd_adj0, fract_out_rnd0} = round ? fract_out_pl1 : {1'b0, fract_out};
assign exp_out_rnd0 =  exp_rnd_adj0 ? exp_out_pl1 : exp_out;
assign ovf0 = exp_out_final_ff & !rmode_01 & !op_f2i;

// round to zero
//assign fract_out_rnd1 = (exp_out_ff & !op_div & !dn & !op_f2i) ? 23'h7fffff : fract_out;
assign fract_out_rnd1 = (exp_out_ff & !op_div & !dn & !op_f2i) ? {`MANT_SIZE + 1{1'b1}} : fract_out;
assign exp_fix_div    = (fi_ldz>`MANT_SIZE) ? exp_fix_diva : exp_fix_divb;
assign exp_out_rnd1   = (g & r & s & exp_in_ff) ? (op_div ? exp_fix_div : exp_next_mi[`EXP_SIZE:0]) :
			(exp_out_ff & !op_f2i) ? exp_in : exp_out;
assign ovf1 = exp_out_ff & !dn;

// round to +inf (UP) and -inf (DOWN)
assign r_sign = sign;

assign round2a = !exp_out_fe | !fract_out_7fffff | (exp_out_fe & fract_out_7fffff);
assign round2_fasu = ((r | s) & !r_sign) & (!exp_out[`EXP_SIZE] | (exp_out[`EXP_SIZE] & round2a));

assign round2_fmul = !r_sign &
		(
			(exp_ovf[1] & !fract_in_00 &
				( ((!exp_out1_co | op_dn) & (r | s | (!rem_00 & op_div) )) | fract_out_00 | (!op_dn & !op_div))
			 ) |
			(
				(r | s | (!rem_00 & op_div)) & (
						(!exp_ovf[1] & (exp_in_80 | !exp_ovf[0])) | op_div |
						( exp_ovf[1] & !exp_ovf[0] & exp_out1_co)
					)
			)
		);

//assign round2_f2i = rmode_10 & (( |fract_in[`MANT_SIZE+1:0] & !opas & (exp_in<8'h80 )) | (|fract_trunc));
assign round2_f2i = rmode_10 & (( |fract_in[`MANT_SIZE+1:0] & !opas & (exp_in<(`BIAS + 1) )) | (|fract_trunc));
assign round2 = (op_mul | op_div) ? round2_fmul : op_f2i ? round2_f2i : round2_fasu;

assign {exp_rnd_adj2a, fract_out_rnd2a} = round2 ? fract_out_pl1 : {1'b0, fract_out};
assign exp_out_rnd2a  = exp_rnd_adj2a ? ((exp_ovf[1] & op_mul) ? exp_out_mi1 : exp_out_pl1) : exp_out;

assign fract_out_rnd2 = (r_sign & exp_out_ff & !op_div & !dn & !op_f2i) ? {`MANT_SIZE + 1{1'b1}} : fract_out_rnd2a;
//assign fract_out_rnd2 = (r_sign & exp_out_ff & !op_div & !dn & !op_f2i) ? 23'h7fffff : fract_out_rnd2a;
assign exp_out_rnd2   = (r_sign & exp_out_ff & !op_f2i) ? 8'hfe      : exp_out_rnd2a;


// Choose rounding mode
always @(rmode or exp_out_rnd0 or exp_out_rnd1 or exp_out_rnd2)
	case(rmode)	// /synopsys full_case parallel_case
	   0: exp_out_rnd = exp_out_rnd0;
	   1: exp_out_rnd = exp_out_rnd1;
	 2,3: exp_out_rnd = exp_out_rnd2;
	default: exp_out_rnd = {`EXP_SIZE{1'bx}};
	endcase

always @(rmode or fract_out_rnd0 or fract_out_rnd1 or fract_out_rnd2)
	case(rmode)	/// synopsys full_case parallel_case
	   0: fract_out_rnd = fract_out_rnd0;
	   1: fract_out_rnd = fract_out_rnd1;
	 2,3: fract_out_rnd = fract_out_rnd2;
	default: fract_out_rnd = {`MANT_SIZE{1'bx}};
	endcase

// ---------------------------------------------------------------------
// Final Output Mux
// Fix Output for denormalized and special numbers
wire	max_num, inf_out;

assign	max_num =  ( !rmode_00 & (op_mul | op_div ) & (
							  ( exp_ovf[1] &  exp_ovf[0]) |
							  (!exp_ovf[1] & !exp_ovf[0] & exp_in_ff & (fi_ldz_2<`MANT_SIZE + 2) & (exp_out!=8'hfe) )
							  )
		   ) |

		   ( op_div & (
				   ( rmode_01 & ( div_inf |
							 (exp_out_ff & !exp_ovf[1] ) |
							 (exp_ovf[1] &  exp_ovf[0] )
						)
				   ) |

				   ( rmode[1] & !exp_ovf[1] & (
								   ( exp_ovf[0] & exp_in_ff & r_sign & fract_in[(`MANT_SIZE + 1) * 2 + 1]
								   ) |

								   (  r_sign & (
										(fract_in[(`MANT_SIZE + 1) * 2 + 1] & div_inf) |
										(exp_in[`EXP_SIZE] & !exp_out_rnd[`EXP_SIZE] & !exp_in_80 & exp_out!=`BIAS ) |
										(exp_in[`EXP_SIZE] &  exp_out_rnd[`EXP_SIZE] & r_sign & exp_out_ff & op_dn &
											 div_exp1>9'h0fe )
										)
								   ) |

								   ( exp_in_00 & r_sign & (
												div_inf |
												(r_sign & exp_out_ff & fi_ldz_2<24)
											  )
								   )
							       )
				  )
			    )
		   );


assign inf_out = (rmode[1] & (op_mul | op_div) & !r_sign & (	(exp_in_ff & !op_div) |
								(exp_ovf[1] & exp_ovf[0] & (exp_in_00 | exp_in[`EXP_SIZE]) )
							   )
		) | (div_inf & op_div & (
				 rmode_00 |
				(rmode[1] & !exp_in_ff & !exp_ovf[1] & !exp_ovf[0] & !r_sign ) |
				(rmode[1] & !exp_ovf[1] & exp_ovf[0] & exp_in_00 & !r_sign)
				)
		) | (op_div & rmode[1] & exp_in_ff & op_dn & !r_sign & (fi_ldz_2 < `MANT_SIZE + 2)  & (exp_out_rnd!=8'hfe) );

/*assign fract_out_final =	(inf_out | ovf0 | output_zero ) ? 23'h0 :
				(max_num | (f2i_max & op_f2i) ) ? {`MANT_SIZE + 1{1'b1}} :
				fract_out_rnd;*/

assign fract_out_final =	(inf_out | ovf0 | output_zero ) ? {`MANT_SIZE + 1{1'b0}} :
      (max_num | (f2i_max & op_f2i) ) ? {`MANT_SIZE + 1{1'b1}} :
        fract_out_rnd;

/*assign exp_out_final =	((op_div & exp_ovf[1] & !exp_ovf[0]) | output_zero ) ? 8'h00 :
			((op_div & exp_ovf[1] &  exp_ovf[0] & rmode_00) | inf_out | (f2i_max & op_f2i) ) ? 8'hff :
			max_num ? 8'hfe :
			exp_out_rnd;
*/
assign exp_out_final =	((op_div & exp_ovf[1] & !exp_ovf[0]) | output_zero ) ? 8'h00 :
      			((op_div & exp_ovf[1] &  exp_ovf[0] & rmode_00) | inf_out | (f2i_max & op_f2i) ) ? (`BIT_SIZE == 63 ? 12'h7ff : 8'hff) :
      			max_num ? 8'hfe :
      			exp_out_rnd;



// ---------------------------------------------------------------------
// Pack Result

assign out = {exp_out_final, fract_out_final};

// ---------------------------------------------------------------------
// Exceptions
wire		underflow_fmul;
wire		overflow_fdiv;
wire		undeflow_div;

wire		z =	shft_co | ( exp_ovf[1] |  exp_in_00) |
			(!exp_ovf[1] & !exp_in_00 & (exp_out1_co | exp_out_00));

assign underflow_fmul = ( (|fract_trunc) & z & !exp_in_ff ) |
			(fract_out_00 & !fract_in_00 & exp_ovf[1]);

assign undeflow_div =	!(exp_ovf[1] &  exp_ovf[0] & rmode_00) & !inf_out & !max_num & exp_out_final!=8'hff & (

			((|fract_trunc) & !opb_dn & (
							( op_dn & !exp_ovf[1] & exp_ovf[0])	|
							( op_dn &  exp_ovf[1])			|
							( op_dn &  div_shft1_co)		|
							  exp_out_00				|
							  exp_ovf[1]
						  )

			) |

			( exp_ovf[1] & !exp_ovf[0] & (
							(  op_dn & exp_in>8'h16 & fi_ldz<`MANT_SIZE+1) |
							(  op_dn & exp_in<(`MANT_SIZE+1) & fi_ldz<(`MANT_SIZE+1) & !rem_00) |
							( !op_dn & (exp_in[`EXP_SIZE]==exp_div[`EXP_SIZE]) & !rem_00) |
							( !op_dn & exp_in_00 & (exp_div[`EXP_SIZE:1]==7'h7f) ) |
							( !op_dn & exp_in<8'h7f & exp_in>8'h20 )
							)
			) |

			(!exp_ovf[1] & !exp_ovf[0] & (
							( op_dn & fi_ldz<(`MANT_SIZE + 1) & exp_out_00) |
							( exp_in_00 & !rem_00) |
							( !op_dn & ldz_all<(`MANT_SIZE + 1) & exp_in==1 & exp_out_00 & !rem_00)
							)
			)

			);

assign underflow = op_div ? undeflow_div : op_mul ? underflow_fmul : (!fract_in[(`MANT_SIZE + 1) * 2 + 1] & exp_out1_co) & !dn;

assign overflow_fdiv =	inf_out |
			(!rmode_00 & max_num) |
			(exp_in[`EXP_SIZE] & op_dn & exp_out_ff) |
			(exp_ovf[0] & (exp_ovf[1] | exp_out_ff) );

assign overflow  = op_div ? overflow_fdiv : (ovf0 | ovf1);

wire		f2i_ine;

assign f2i_ine =	(f2i_zero & !fract_in_00 & !opas) |
			(|fract_trunc) |
			(f2i_zero & (exp_in<(`BIAS + 1)) & opas & !fract_in_00) |
			(f2i_max & rmode_11 & (exp_in<(`BIAS + 1)));



assign ine =	op_f2i ? f2i_ine :
		op_i2f ? (|fract_trunc) :
		((r & !dn) | (s & !dn) | max_num | (op_div & !rem_00));

// ---------------------------------------------------------------------
// Debugging Stuff

// synopsys translate_off

wire	[`MANT_SIZE + 4:0]	fracta_del, fractb_del;
wire	[2:0]	grs_del;
wire		dn_del;
wire	[`EXP_SIZE:0]	exp_in_del;
wire	[`EXP_SIZE:0]	exp_out_del;
wire	[`MANT_SIZE:0]	fract_out_del;
wire	[(`MANT_SIZE + 1) * 2 + 1:0]	fract_in_del;
wire		overflow_del;
wire	[1:0]	exp_ovf_del;
wire	[`MANT_SIZE:0]	fract_out_x_del, fract_out_rnd2a_del;
wire	[`MANT_SIZE + 2:0]	trunc_xx_del;
wire		exp_rnd_adj2a_del;
wire	[`MANT_SIZE:0]	fract_dn_del;
wire	[4:0]	div_opa_ldz_del;
wire	[`MANT_SIZE + 1:0]	fracta_div_del;
wire	[`MANT_SIZE + 1:0]	fractb_div_del;
wire		div_inf_del;
wire	[`EXP_SIZE:0]	fi_ldz_2_del;
wire		inf_out_del, max_out_del;
wire	[6:0]	fi_ldz_del;
wire		rx_del;
wire		ez_del;
wire		lr;
wire	[`EXP_SIZE:0]	shr, shl, exp_div_del;
wire		wire_max_num_del;
wire		max_num_del;
delay2 #(`MANT_SIZE + 4) ud000(clk, test.u0.fracta, fracta_del);
delay2 #(`MANT_SIZE + 4) ud001(clk, test.u0.fractb, fractb_del);
delay1  #2 ud002(clk, {g,r,s}, grs_del);
delay1  #0 ud004(clk, dn, dn_del);
delay1  #(`EXP_SIZE) ud005(clk, exp_in, exp_in_del);
delay1  #(`EXP_SIZE) ud007(clk, exp_out_rnd, exp_out_del);
delay1 #((`MANT_SIZE + 1) * 2 + 1) ud009(clk, fract_in, fract_in_del);
delay1  #0 ud010(clk, overflow, overflow_del);
delay1  #1 ud011(clk, exp_ovf, exp_ovf_del);
delay1 #(`MANT_SIZE) ud014(clk, fract_out, fract_out_x_del);
delay1 #(`MANT_SIZE + 2) ud015(clk, fract_trunc, trunc_xx_del);
delay1 	#0 ud017(clk, exp_rnd_adj2a, exp_rnd_adj2a_del);
delay1  #4 ud019(clk, div_opa_ldz, div_opa_ldz_del);
delay3 #(`MANT_SIZE + 1) ud020(clk, test.u0.fdiv_opa[(`MANT_SIZE+1) * 2 + 3 :(`MANT_SIZE+1) * 2 + 3 - (`MANT_SIZE + 1)],	fracta_div_del); //TODO CHANGE THIS
delay3 #(`MANT_SIZE + 1) ud021(clk, test.u0.fractb_mul,	fractb_div_del);
delay1 	#0 ud023(clk, div_inf, div_inf_del);
delay1  #(`EXP_SIZE) ud024(clk, fi_ldz_2, fi_ldz_2_del);
delay1 	#0 ud025(clk, inf_out, inf_out_del);
delay1 	#0 ud026(clk, max_num, max_num_del);
delay1 	#6 ud027(clk, fi_ldz, fi_ldz_del);
delay1  #0 ud028(clk, rem_00, rx_del);

delay1  #0 ud029(clk, left_right, lr);
delay1  #(`EXP_SIZE) ud030(clk, shift_right, shr);
delay1  #(`EXP_SIZE) ud031(clk, shift_left, shl);
delay1 #(`MANT_SIZE) ud032(clk, fract_out_rnd2a, fract_out_rnd2a_del);

delay1  #(`EXP_SIZE) ud033(clk, exp_div, exp_div_del);

always @(test.error_event)
   begin

	$display("\n----------------------------------------------");

	$display("ERROR: GRS: %b exp_ovf: %b dn: %h exp_in: %h exp_out: %h, exp_rnd_adj2a: %b",
			grs_del, exp_ovf_del, dn_del, exp_in_del, exp_out_del, exp_rnd_adj2a_del);

	$display("      div_opa: %b, div_opb: %b, rem_00: %b, exp_div: %h",
			fracta_div_del, fractb_div_del, rx_del, exp_div_del);

	$display("      lr: %b, shl: %h, shr: %h",
			lr, shl, shr);


	$display("       overflow: %b, fract_in=%b  fa:%h fb:%h",
			overflow_del, fract_in_del, fracta_del, fractb_del);

	$display("       div_opa_ldz: %h, div_inf: %b, inf_out: %b, max_num: %b, fi_ldz: %h, fi_ldz_2: %h",
			div_opa_ldz_del, div_inf_del, inf_out_del, max_num_del, fi_ldz_del, fi_ldz_2_del);

	$display("       fract_out_x: %b, fract_out_rnd2a_del: %h, fract_trunc: %b\n",
			fract_out_x_del, fract_out_rnd2a_del, trunc_xx_del);
   end


// synopsys translate_on

endmodule

// synopsys translate_off

module delay1(clk, in, out);
parameter	N = 1;
input	[N:0]	in;
output	[N:0]	out;
input		clk;

reg	[N:0]	out;

always @(posedge clk)
	out <= #1 in;

endmodule


module delay2(clk, in, out);
parameter	N = 1;
input	[N:0]	in;
output	[N:0]	out;
input		clk;

reg	[N:0]	out, r1;

always @(posedge clk)
	r1 <= #1 in;

always @(posedge clk)
	out <= #1 r1;

endmodule

module delay3(clk, in, out);
parameter	N = 1;
input	[N:0]	in;
output	[N:0]	out;
input		clk;

reg	[N:0]	out, r1, r2;

always @(posedge clk)
	r1 <= #1 in;

always @(posedge clk)
	r2 <= #1 r1;

always @(posedge clk)
	out <= #1 r2;

endmodule

// synopsys translate_on
